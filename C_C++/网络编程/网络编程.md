# 网络编程

## TCP/IP

### 特性

1. Connectionless Packet Delivery Service

   是其他网络服务的基础，几乎所有数据包交换网络都提供这种服务。TCP/IP是根据信息中所含的位置来进行的数据传送的，它不能确保每个独立路由的数据包可靠和依序地到达目的地。在每一个连线过程中，线路都不是被“独占”的，而是直接映射到硬件位置上，因此特别有效。更重要的是，此种数据包交换方式的传送使得TCP/IP能适应各种不同的网络硬件设备。

2. Reliable Stream Transport Service

   因为数据包交换并不能确保每一个数据包的可靠性，因此就需要通信软件来自动侦测和修复传送过程中可能出现的错误，以及处理不良的数据包。这种服务用来确保计算机程序之间能够建立连接、传送大量数据。关键的技术是将数据流进行切割，然后编号传送，再通过接收方的确认（Acknowledgement）来保证数据的完整性。

3. Network Technology Independent

   在数据包交换技术中，TCP/IP是独立于硬件之上的。TCP/IP有自己的一套数据包规则和定义，能应用在不同的网络上。

4. Universal Interconnection

   只要用TCP/IP连接网络，就将获得一个独一无二的识别地址。数据包在交换的过程中是以位置为依据的，不管数据包所经过的路由选择如何，数据都能被送达指定的位址。

5. End-to-End Acknowledgements

   TCP/IP的确认模式是以端到端进行的，这样就无须理会数据包交换过程中所参与的其他设备，发送端和接收端相互确认才是我们关心的。

6. Application Protocol Standards

   TCP/IP除提供基础的传送服务外，还提供许多一般应用标准，让程序设计人员更有标准可依，而且还可节省许多不必要的重复开发。

### 互联网地址

- IPV4 	32位
- IPV6   128位

分为5类：

- A类

  0 + 网络号（7位）+主机号（24位）

- B类

  10 + 网络号（14位）+主机号（16位）

- C类

  110 + 网络号（21位）+主机号（8位）

- D类

  1110 + 多播组号（28位）

- E类

  11110 + 留待后用（27位）

IP地址分为3类：

- 单播地址

  目的端为单个主机

- 广播地址

  目的端为给定网络上的所有主机

- 多播地址

  目的端为同一组内的所有主机

### 域名系统

在TCP/IP领域中，域名系统（DNS）是一个分布式的数据库，由它来提供IP地址和主机名之间的映射信息。

### 封装

图

以太网数据帧的物理特性是其长度必须在 46~1500 字节之间。

IP在首部中存入一个长度为 8 位的数值，称作协议域，1表示ICMP协议，2表示IGMP协议，6表示TCP协议，17表示UDP协议。

TCP 和 UDP 都用一个 16位的端口号来表示不同的应用程序。TCP和UDP把源端口号和目的端口号分别放入消息首部中。

### TCP/IP协议

图



#### 应用层

应用层由使用TCP/IP 进行通信的程序所提供。应用层和传输层之间的接口由端口号和套接字所定义

#### 传输层

传输层提供了端到端的数据传输，把数据从一个应用传输到它的远程对等实体，传输层可以同时支持多个应用。最常用的传输层协议是传输控制协议（Transmission Control Protocol,TCP），它提供了面向连接的可靠的数据传送、重复数据抑制、拥塞控制，以及流量控制。

用户数据报协议（User Datagram Protocol,UDP），它提供了一种无连接、不可靠、尽力传送（Best-effort）的服务。因此，如果用户需要，使用UDP作为传输协议的应用就必须提供各自的端到端的完整性、流量控制和拥塞控制。

#### 网络层

网际协议（Internet Protocol,IP）是这一层中最重要的协议，它是一种无连接的协议，不负责下层的传输可靠性。IP提供了路由功能，它视图把发送的消息传输到目的端。IP网络中的消息单位为 IP 数据报，这是TCP/IP网络上传输的基本信息单位。互联网络层的其他协议有 IP、IMCP、IGMP、ARP 以及 RARP。

#### 网络接口层

网络接口层也叫做链路层（Link Layer）或者数据链路层（Data-link Layer），是实际网络硬件的接口。

### TCP/IP应用

1. 既可以是用户编写的应用，也可以是 TCP/IP 产品所带来的标准应用。实际上，TCP/IP协议族包含如下一些协议。
2. 它们使用